From a9367aa77ca5579d92c7e47af37f3373f541f1da Mon Sep 17 00:00:00 2001
From: Mark Madsen <mm@idyll.io>
Date: Tue, 4 Jul 2017 23:53:42 -0600
Subject: [PATCH] Backport fix of ERL-439 for maint-19

---
 erts/configure.in | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/erts/configure.in b/erts/configure.in
index ad9a66126f68896043656ee0f50e8ddee25b269f..22f4bc630755e3f9c5a40313159fdd853b3746ad 100644
--- a/erts/configure.in
+++ b/erts/configure.in
@@ -3752,7 +3752,7 @@ case $host_os in
 	darwin*)
 		# Mach-O linker: a shared lib and a loadable
 		# object file is not the same thing.
-		DED_LDFLAGS="-bundle -flat_namespace -undefined suppress"
+		DED_LDFLAGS="-bundle -bundle_loader ${ERL_TOP}/bin/$host/beam.smp"
 		case $ARCH in
 			amd64)
 				DED_LDFLAGS="-m64 $DED_LDFLAGS"
--- a/lib/wx/c_src/wxe_impl.cpp
+++ b/lib/wx/c_src/wxe_impl.cpp
@@ -666,7 +666,7 @@ void * WxeApp::getPtr(char * bp, wxeMemE
     throw wxe_badarg(index);
   }
   void * temp = memenv->ref2ptr[index];
-  if((index < memenv->next) && ((index == 0) || (temp > NULL)))
+  if((index < memenv->next) && ((index == 0) || (temp != NULL)))
     return temp;
   else {
     throw wxe_badarg(index);
@@ -678,7 +678,7 @@ void WxeApp::registerPid(char * bp, ErlD
   if(!memenv)
     throw wxe_badarg(index);
   void * temp = memenv->ref2ptr[index];
-  if((index < memenv->next) && ((index == 0) || (temp > NULL))) {
+  if((index < memenv->next) && ((index == 0) || (temp != NULL))) {
     ptrMap::iterator it;
     it = ptr2ref.find(temp);
     if(it != ptr2ref.end()) {
